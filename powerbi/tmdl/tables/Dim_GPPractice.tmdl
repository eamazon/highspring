table Dim_GPPractice
	lineageTag: g1b2c3d4-e5f6-7890-abcd-ef1234567890

	column GPPracticeKey
		dataType: int64
		isKey
		formatString: 0
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef1234567891
		summarizeBy: none
		sourceColumn: GPPracticeKey

	column 'GP Practice Code'
		dataType: string
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef1234567892
		summarizeBy: none
		sourceColumn: GP Practice Code

	column 'GP Practice'
		dataType: string
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef1234567893
		summarizeBy: none
		sourceColumn: GP Practice

	column 'Practice Category'
		dataType: string
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef1234567894
		summarizeBy: none
		sourceColumn: Practice Category

	column 'Prescribing Setting'
		dataType: string
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef1234567895
		summarizeBy: none
		sourceColumn: Prescribing Setting

	column Town
		dataType: string
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef1234567896
		summarizeBy: none
		sourceColumn: Town

	column Postcode
		dataType: string
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef1234567897
		summarizeBy: none
		sourceColumn: Postcode

	column 'PCN Code'
		dataType: string
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef1234567898
		summarizeBy: none
		sourceColumn: PCN Code

	column PCN
		dataType: string
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef1234567899
		summarizeBy: none
		sourceColumn: PCN

	column 'Sub-ICB Code'
		dataType: string
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef123456789a
		summarizeBy: none
		sourceColumn: Sub-ICB Code

	column Sub-ICB
		dataType: string
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef123456789b
		summarizeBy: none
		sourceColumn: Sub-ICB

	column 'ICB Code'
		dataType: string
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef123456789c
		summarizeBy: none
		sourceColumn: ICB Code

	column ICB
		dataType: string
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef123456789d
		summarizeBy: none
		sourceColumn: ICB

	column 'ICB Group'
		dataType: string
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef123456789e
		summarizeBy: none
		sourceColumn: ICB Group

	column 'ICB Group Sort'
		dataType: int64
		formatString: 0
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef123456789f
		summarizeBy: none
		sourceColumn: ICB Group Sort

	column 'Registration Status'
		dataType: string
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef1234567900
		summarizeBy: none
		sourceColumn: Registration Status

	column 'Is Active'
		dataType: boolean
		formatString: """TRUE"";""TRUE"";""FALSE"""
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef1234567901
		summarizeBy: none
		sourceColumn: Is Active

	column 'Is Current'
		dataType: boolean
		formatString: """TRUE"";""TRUE"";""FALSE"""
		lineageTag: g1e2f3a4-b5c6-7890-abcd-ef1234567902
		summarizeBy: none
		sourceColumn: Is Current

	partition Dim_GPPractice = m
		mode: import
		source =
				let
				    Source = Sql.Database("PSFADHSSTP02.ad.elc.nhs.uk\SWL", "Data_Lab_SWL_Live", [Query="
				        SELECT
				            [SK_GPPracticeID]       AS [GPPracticeKey],
				            [GPPractice_Code]       AS [GP Practice Code],
				            [GPPractice_Name]       AS [GP Practice],
				            [Practice_Category]     AS [Practice Category],
				            [Prescribing_Setting]   AS [Prescribing Setting],
				            [Town]                  AS [Town],
				            [Postcode]              AS [Postcode],
				            [PCN_Code]              AS [PCN Code],
				            [PCN_Name]              AS [PCN],
				            [SubICB_Code]           AS [Sub-ICB Code],
				            [SubICB_Name]           AS [Sub-ICB],
				            [ICB_Code]              AS [ICB Code],
				            [ICB_Name]              AS [ICB],
				            [ICB_Grouping]          AS [ICB Group],
				            [ICB_Grouping_Sort]     AS [ICB Group Sort],
				            [Registration_Status]   AS [Registration Status],
				            [Is_Active]             AS [Is Active],
				            [Is_Current]            AS [Is Current]
				        FROM [Analytics].[tbl_Dim_GPPractice]
				        WHERE [Is_Current] = 1
				           OR [SK_GPPracticeID] IN (-1, -2, -3, -4)
				    "])
				in
				    Source

